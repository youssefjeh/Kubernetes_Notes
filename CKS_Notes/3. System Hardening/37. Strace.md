## ğŸ§  1. C'est quoi un **syscall** exactement ?

Un **syscall** (appel systÃ¨me) est une **porte dâ€™entrÃ©e entre un programme et le noyau Linux**.

Quand un programme veut :

* Lire ou Ã©crire un fichier â†’ il fait `read()`, `write()`
* Ouvrir un socket rÃ©seau â†’ `socket()`, `connect()`
* Tuer un processus â†’ `kill()`
* Attendre un Ã©vÃ©nement â†’ `epoll_wait()`
* CrÃ©er un fichier â†’ `open()`

â¡ï¸ Tout Ã§a passe par des **syscalls**. Ce sont les **ordres qu'un programme donne au systÃ¨me dâ€™exploitation**.

---

## ğŸ§ª 2. Et `strace` dans tout Ã§a ?

`strace` est un **outil dâ€™observation**. Il montre :

* **Quelles actions systÃ¨me sont demandÃ©es par un processus**
* **Quand** et **avec quels paramÃ¨tres**
* **Sâ€™il y a des erreurs**

Câ€™est comme **Ã©couter les ordres dâ€™un pilote Ã  sa tour de contrÃ´le**.

---

## ğŸ” 3. Pourquoi c'est utile pour la **sÃ©curitÃ©** ?

### Exemple 1 : Le kube-apiserver accÃ¨de Ã  des certificats

Avec `strace`, tu peux voir :

```bash
open("/etc/kubernetes/pki/apiserver.key", O_RDONLY) = 3
```

â¡ï¸ Tu confirmes quâ€™il lit **le bon fichier**, et **pas un fichier malveillant**.

---

### Exemple 2 : Une app tente de se connecter Ã  un port interdit

```bash
connect(6, {sa_family=AF_INET, sin_port=htons(22), ...}) = -1
```

â¡ï¸ Tu vois quâ€™un conteneur essaie dâ€™ouvrir une connexion vers SSH. Bizarre ? Tu as peut-Ãªtre un conteneur compromis.

---

### Exemple 3 : Un processus fait un `execve("/bin/bash", ...)`

â¡ï¸ Il essaie peut-Ãªtre de **lancer un shell** â†’ alerte possible !

---

## ğŸ” 4. Et dans le contexte **Kubernetes** ?

Kubernetes **cache beaucoup de choses** (pods, services, containers, etc.). `strace` te permet de :

### âœ”ï¸ Auditer le comportement rÃ©el

Tu veux savoir ce que fait **kube-apiserver** ? Ou un conteneur ?
â¡ï¸ Tu lances `strace`, tu vois **tout ce quâ€™il lit, Ã©crit, envoie, Ã©coute**.

### âœ”ï¸ DÃ©tecter des comportements anormaux

Tu peux voir :

* Tentatives dâ€™accÃ¨s Ã  des fichiers systÃ¨me sensibles (`/etc/shadow`)
* Ouverture de ports inattendus
* Ã‰chec d'accÃ¨s Ã  des secrets

### âœ”ï¸ Aider Ã  la **debug et forensic**

Quand un pod plante sans message utile, tu peux :

```bash
strace -p <pid>
```

Et observer le syscall oÃ¹ il bloque ou Ã©choue.

---

## ğŸ¯ RÃ©sumÃ© : rÃ´le de `strace` dans la sÃ©curitÃ©

| Utilisation                   | Pourquoi c'est utile ?                                    |
| ----------------------------- | --------------------------------------------------------- |
| Surveiller les accÃ¨s fichiers | VÃ©rifie que lâ€™app lit les bons certificats, secrets, etc. |
| Surveiller les connexions     | DÃ©tecte des accÃ¨s rÃ©seau suspects                         |
| DÃ©boguer un processus bloquÃ©  | Vois sur quel syscall il se fige                          |
| Comprendre un binaire inconnu | Analyse comportement sans code source                     |
| Forensic (post-incident)      | Prouve ce quâ€™un processus a essayÃ© de faire               |

---

## ğŸ› ï¸ Si tu veux tester facilement :

Fais tourner un pod simple avec une commande comme `curl`, puis :

```bash
strace -f -p <PID_DU_CONTAINER>
```

Et tu vas **voir les vraies actions** faites par le processus dans le conteneur.
