Les **CIS Benchmarks** sont des **rÃ©fÃ©rentiels de bonnes pratiques de sÃ©curitÃ©** publiÃ©s par le **Center for Internet Security (CIS)**.

---

### ğŸ›¡ï¸ En rÃ©sumÃ© :

* Ce sont des **guides dÃ©taillÃ©s** pour **sÃ©curiser les systÃ¨mes, logiciels, services cloud et conteneurs**.
* Chaque benchmark te dit **quoi configurer, pourquoi, et comment** (par exemple sur Linux, Kubernetes, Docker, AWSâ€¦).
* Ils sont souvent utilisÃ©s pour :

  * les **audits de sÃ©curitÃ©**
  * la **conformitÃ© rÃ©glementaire** (ex : ISO 27001, SOC2, etc.)
  * les **scans automatisÃ©s** avec des outils comme **kube-bench** (pour Kubernetes)

---

### ğŸ“˜ Exemple :

Le **CIS Kubernetes Benchmark** recommande :

* dâ€™empÃªcher lâ€™accÃ¨s anonyme Ã  lâ€™API Kubernetes,
* de chiffrer les secrets,
* de restreindre les ports ouverts sur les nÅ“uds,
* etc.

Bien sÃ»r ! Voici un **exemple concret** dâ€™une recommandation issue du **CIS Kubernetes Benchmark** :

---

### âœ… Exemple : **DÃ©sactiver lâ€™accÃ¨s anonyme Ã  lâ€™API Server**

#### ğŸ“Œ **ID** : 1.2.1 â€” Ensure that the `--anonymous-auth` argument is set to `false`

---

### ğŸ” Contexte :

Par dÃ©faut, Kubernetes peut autoriser des requÃªtes anonymes (non authentifiÃ©es) Ã  son API. Cela peut ouvrir des failles si une ressource est exposÃ©e par erreur.

---

### ğŸ’¡ **Recommandation :**

Configurer le composant **kube-apiserver** avec lâ€™option suivante :

```bash
--anonymous-auth=false
```

---

### ğŸ“ Pourquoi ?

* Cela **oblige toute connexion Ã  lâ€™API Ã  Ãªtre authentifiÃ©e**.
* Ã‰vite que des utilisateurs non identifiÃ©s puissent accÃ©der ou sonder lâ€™API.

---

### ğŸ§ª Comment vÃ©rifier :

Sur le nÅ“ud maÃ®tre, exÃ©cuter :

```bash
ps -ef | grep kube-apiserver
```

VÃ©rifie que tu vois bien :

```bash
--anonymous-auth=false
```

---

### ğŸ› ï¸ RemÃ©diation :

Si absent ou mal configurÃ©, modifie le **fichier de configuration systÃ¨me** (ex. `/etc/kubernetes/manifests/kube-apiserver.yaml` si kubeadm) pour inclure :

```yaml
- --anonymous-auth=false
```

Puis redÃ©marre le composant si nÃ©cessaire.

---


 Voici un petit **script bash** qui vÃ©rifie si le paramÃ¨tre `--anonymous-auth=false` est bien appliquÃ© au **kube-apiserver** sur un cluster Kubernetes (gÃ©rÃ© avec kubeadm par exemple) :


### ğŸ–¥ï¸ Script : VÃ©rification `anonymous-auth`

```bash
#!/bin/bash

echo "ğŸ” VÃ©rification du paramÃ¨tre --anonymous-auth sur le kube-apiserver..."

CONFIG_FILE="/etc/kubernetes/manifests/kube-apiserver.yaml"

if [ ! -f "$CONFIG_FILE" ]; then
    echo "âŒ Fichier kube-apiserver non trouvÃ© Ã  l'emplacement attendu : $CONFIG_FILE"
    exit 1
fi

if grep -q -- "--anonymous-auth=false" "$CONFIG_FILE"; then
    echo "âœ… Le paramÃ¨tre --anonymous-auth=false est correctement configurÃ©."
else
    echo "âš ï¸ Le paramÃ¨tre --anonymous-auth=false est MANQUANT ou mal configurÃ© !"
    echo "ğŸ‘‰ Pour corriger, ajoute la ligne suivante dans le fichier :"
    echo "    - --anonymous-auth=false"
fi
```

---

### ğŸ“¦ Pour exÃ©cuter :

1. Copie-colle ce script dans un fichier, par exemple `check-anonymous-auth.sh`
2. Donne-lui les droits dâ€™exÃ©cution :

   ```bash
   chmod +x check-anonymous-auth.sh
   ```
3. Lance-le avec `sudo` :

   ```bash
   sudo ./check-anonymous-auth.sh
   ```

