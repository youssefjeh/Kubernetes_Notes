## âš™ï¸ Contexte

On veut contrÃ´ler **qui peut envoyer du trafic aux pods dans le namespace `namespace-ui`**. On utilise une `NetworkPolicy` pour Ã§a.

> ğŸ§  Les deux champs (`matchLabels` et `matchExpressions`) servent Ã  **sÃ©lectionner les namespaces** **en fonction de leurs labels**.

---

## ğŸ”¹ Exemple 1 : `matchLabels` (simple Ã©galitÃ©)

```yaml
namespaceSelector:
  matchLabels:
    team: frontend
```

â¡ Cela **autorise uniquement** les namespaces qui ont **exactement ce label** :

```bash
kubectl label namespace namespace-web team=frontend
```

Si un namespace **nâ€™a pas le label `team=frontend`**, **il ne pourra pas communiquer** avec les pods ciblÃ©s.

---

## ğŸ”¸ Exemple 2 : `matchExpressions` (condition logique)

```yaml
namespaceSelector:
  matchExpressions:
  - key: team
    operator: In
    values:
    - frontend
    - backend
```

â¡ Cela **autorise tous les namespaces qui ont un label `team` dont la valeur est soit `frontend` soit `backend`**.

Donc :

```bash
kubectl label namespace namespace-web team=frontend
kubectl label namespace namespace-api team=backend
```

Les deux namespaces (`namespace-web`, `namespace-api`) pourront envoyer du trafic aux pods dans `namespace-ui`.

---

## âš ï¸ Attention

Les deux sÃ©lecteurs **ne fonctionnent que si les namespaces sont labellisÃ©s**. Exemple :

```bash
kubectl get namespace --show-labels
```

Si un namespace **nâ€™a pas le bon label**, **il ne passera pas le filtre**, mÃªme sâ€™il sâ€™appelle `namespace-web`.

---

## ğŸ“Œ Comparaison rapide

| Fonction            | `matchLabels`            | `matchExpressions`                                        |
| ------------------- | ------------------------ | --------------------------------------------------------- |
| SimplicitÃ©          | âœ… Plus simple            | âŒ Un peu plus complexe                                    |
| Filtrage multiple   | âŒ Non (1 valeur)         | âœ… Oui (plusieurs valeurs)                                 |
| OpÃ©rateurs logiques | âŒ Non                    | âœ… `In`, `NotIn`, `Exists`, etc.                           |
| Utilisation typique | Cas simple (1 namespace) | Cas avancÃ© (plusieurs namespaces, logique conditionnelle) |

---

## ğŸ’¡ Recommandation

* Pour un cas simple avec un seul namespace âœ **utilisez `matchLabels`**
* Pour un cas oÃ¹ plusieurs namespaces sont autorisÃ©s âœ **utilisez `matchExpressions`**