## üõ°Ô∏è S√©curisation de la communication entre pods avec mTLS

### üîì Probl√®me initial

* Par d√©faut, **la communication entre deux pods dans Kubernetes n‚Äôest pas chiffr√©e**.
* Exemple : **Pod A** (Webapp1) communique avec **Pod B** (Webapp2) ‚Üí les donn√©es transitent **en clair** (non s√©curis√©es).

---

## ‚ùå Probl√®me avec chiffrement g√©r√© par l'application

### Exemple :

* **Pod 1** : Webapp1 avec Apache ‚Üí utilise un algorithme de chiffrement propre
* **Pod 2** : Webapp2 avec Nginx ‚Üí utilise un autre algorithme de chiffrement
* **Pod 3** : Base de donn√©es MySQL ‚Üí doit comprendre **les deux types de chiffrement** pour accepter les connexions.

üéØ **Probl√®me** :

* Cela **complexifie √©norm√©ment le code**.
* Chaque service doit conna√Ætre et g√©rer plusieurs m√©thodes de chiffrement.

---

## ‚úÖ Solution : mTLS g√©r√© par un service mesh (Istio ou Linkerd)

üí° Plut√¥t que de faire chiffrer les donn√©es par l‚Äôapplication elle-m√™me, on peut **utiliser un service mesh** comme **Istio** ou **Linkerd**.

### Avantages :

* Les applications continuent de communiquer **en clair**, sans se soucier du chiffrement.
* Le chiffrement est **automatiquement g√©r√© par le service mesh**.

---

## üîê Fonctionnement d'Istio avec mTLS

### Sidecar proxy

* Istio **injecte un conteneur "sidecar"** (g√©n√©ralement Envoy proxy) dans chaque pod (par exemple, Webapp1 et MySQL).

### Flux de communication :

1. L‚Äôapplication Webapp1 envoie un message √† MySQL.
2. Ce message est intercept√© **par le sidecar Istio** dans le pod Webapp1.
3. Le **sidecar chiffre** le message avec mTLS.
4. Le message arrive au **sidecar Istio du pod MySQL**, qui **le d√©chiffre**.
5. Le message est transmis en clair √† MySQL.

üß† R√©sultat : **les applications n'ont aucune id√©e que le chiffrement est utilis√©**, tout est g√©r√© automatiquement.

---

## üîß Modes de mTLS dans Istio

Istio propose diff√©rents **niveaux de s√©curit√©** :

| Mode           | Description                                                                                        |
| -------------- | -------------------------------------------------------------------------------------------------- |
| **Permissive** | Accepte √† la fois le trafic chiffr√© (mTLS) et non chiffr√©. Pratique pour la migration progressive. |
| **Strict**     | N‚Äôaccepte **que** le trafic mTLS. Plus s√©curis√©, √† utiliser en production.                         |

---

## ‚úçÔ∏è R√©sum√© clair

* Les pods ne chiffrent **pas eux-m√™mes** les communications.
* Istio injecte un sidecar qui se charge de **chiffrer/d√©chiffrer avec mTLS**.
* Cela permet une **s√©curit√© forte**, **sans changer le code** des applications.
* Plusieurs modes sont disponibles pour g√©rer la transition.

