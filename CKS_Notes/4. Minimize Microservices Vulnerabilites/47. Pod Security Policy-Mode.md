Allons maintenant voir les **modes** de PSA : `enforce`, `audit`, `warn`.
---

## ğŸ§© Il y a **3 modes** dans PSA

Ils servent Ã  **diffÃ©rentes choses** :

| Mode      | Ce que Ã§a fait                                                   |
| --------- | ---------------------------------------------------------------- |
| `enforce` | âŒ **Bloque** les pods qui ne respectent pas les rÃ¨gles           |
| `warn`    | âš ï¸ **Accepte**, mais affiche un **avertissement** dans `kubectl` |
| `audit`   | ğŸ“œ **Enregistre** lâ€™erreur dans les logs, mais nâ€™affiche rien    |

---

## ğŸ“Œ 1. Mode `enforce` (le plus important)

Câ€™est le **mode de sÃ©curitÃ© rÃ©el**.
Il dit Ã  Kubernetes :

> "Si le pod ne respecte pas les rÃ¨gles, tu le bloques."

```bash
kubectl label ns securite \
  pod-security.kubernetes.io/enforce=restricted \
  --overwrite
```

ğŸ‘‰ Ce que Ã§a fait :

* Un pod dangereux ? âŒ BLOQUÃ‰
* Un pod conforme ? âœ… AcceptÃ©

---

## ğŸ“Œ 2. Mode `warn`

Câ€™est un mode pour **tester sans bloquer**.
Il **laisse passer** les pods mais affiche un **message dâ€™avertissement**.

```bash
kubectl label ns securite \
  pod-security.kubernetes.io/warn=restricted \
  --overwrite
```

Exemple : si tu fais :

```bash
kubectl run nginx --image=nginx -n securite
```

Tu verras quelque chose comme :

```
Warning: would violate "restricted" PodSecurity...
```

ğŸ‘‰ Mais le pod sera **quand mÃªme crÃ©Ã© !**

---

## ğŸ“Œ 3. Mode `audit`

Câ€™est utilisÃ© pour les **logs internes du cluster**.
Il **nâ€™affiche rien** pour toi, mais les erreurs sont **enregistrÃ©es dans les logs dâ€™audit** du cluster (si activÃ©).

Tu peux activer comme Ã§a :

```bash
kubectl label ns securite \
  pod-security.kubernetes.io/audit=restricted \
  --overwrite
```

---

## ğŸ”„ Tu peux combiner les 3

Câ€™est trÃ¨s utile pour **faire une migration** en douceur.

```bash
kubectl label ns securite \
  pod-security.kubernetes.io/enforce=baseline \
  pod-security.kubernetes.io/warn=restricted \
  pod-security.kubernetes.io/audit=restricted \
  --overwrite
```

ğŸ‘‰ Cela veut dire :

* âœ… Bloque ce qui dÃ©passe `baseline`
* âš ï¸ Affiche un warning si on dÃ©passe `restricted`
* ğŸ“œ Enregistre tout ce qui dÃ©passe `restricted` dans les logs

---

## ğŸ§  Astuce mÃ©mo

| Mode      | Action          | Quand lâ€™utiliser ?                    |
| --------- | --------------- | ------------------------------------- |
| `enforce` | Bloque          | En production                         |
| `warn`    | Affiche warning | En test / avant migration             |
| `audit`   | Enregistre logs | Pour les Ã©quipes sÃ©curitÃ© (optionnel) |

---