## ğŸ”§ Objectif :

GÃ©nÃ©rer des certificats pour des composants comme :

* kube-apiserver
* kubelet
* kube-controller-manager
* etcd
* etc.

Mais ici, on va simplifier en crÃ©ant :

1. Un **certificat racine (Root CA)**.
2. Un **certificat signÃ© pour un composant Kubernetes**, par exemple `kubelet`.

---

## ğŸªœ Ã‰tapes (avec commandes OpenSSL)

---

### âœ… 1. CrÃ©er le certificat racine (Root CA)

```bash
# 1.1 GÃ©nÃ©rer la clÃ© privÃ©e du CA
openssl genrsa -out ca.key 2048

# 1.2 CrÃ©er le certificat du CA (auto-signÃ©, valable 10 ans)
openssl req -x509 -new -nodes -key ca.key -subj "/CN=k8s-root-ca" -days 3650 -out ca.crt
```

---

### âœ… 2. GÃ©nÃ©rer la clÃ© privÃ©e du composant (ex: kubelet)

```bash
openssl genrsa -out kubelet.key 2048
```

---

### âœ… 3. CrÃ©er un CSR (Certificate Signing Request)

```bash
openssl req -new -key kubelet.key -subj "/CN=kubelet" -out kubelet.csr
```

* Ici `/CN=kubelet` est le **nom commun** (Common Name), qui peut reprÃ©senter l'identitÃ© du composant.

---

### âœ… 4. Signer le certificat avec le Root CA

```bash
openssl x509 -req -in kubelet.csr -CA ca.crt -CAkey ca.key -CAcreateserial \
  -out kubelet.crt -days 365 -extensions v3_req
```

---

### âœ… RÃ©sultat :

Tu as maintenant :

* `ca.crt` â†’ Le certificat racine (Ã  distribuer aux clients pour quâ€™ils fassent confiance)
* `kubelet.key` â†’ La clÃ© privÃ©e du composant
* `kubelet.crt` â†’ Le certificat signÃ© pour kubelet

---

## ğŸ“¦ Structure finale :

```plaintext
.
â”œâ”€â”€ ca.crt          â† Certificat racine (public)
â”œâ”€â”€ ca.key          â† ClÃ© privÃ©e du CA (garde-la secrÃ¨te)
â”œâ”€â”€ kubelet.csr     â† RequÃªte de signature
â”œâ”€â”€ kubelet.crt     â† Certificat signÃ© pour kubelet
â”œâ”€â”€ kubelet.key     â† ClÃ© privÃ©e de kubelet
```

---

## ğŸ¯ Utilisation :

Ces certificats sont utilisÃ©s par les composants Kubernetes pour :

* Sâ€™**authentifier** entre eux (client/serveur)
* Assurer des connexions **TLS sÃ©curisÃ©es**

https://github.com/mmumshad/kubernetes-the-hard-way/tree/master/tools 